---
layout: default
---
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript">
  (function ($) {

    var Vector = function (x, y) {

      this.x = x || 0;

      this.y = y || 0;

    };

    Vector.prototype = {

      add: function (v) {

        this.x += v.x;

        this.y += v.y;

        return this;

      },

      length: function () {

        return Math.sqrt(this.x * this.x + this.y * this.y);

      },

      rotate: function (theta) {

        var x = this.x;

        var y = this.y;

        this.x = Math.cos(theta) * this.x - Math.sin(theta) * this.y;

        this.y = Math.sin(theta) * this.x + Math.cos(theta) * this.y;

        //this.x = Math.cos(theta) * x - Math.sin(theta) * y;

        //this.y = Math.sin(theta) * x + Math.cos(theta) * y;

        return this;

      },

      mult: function (f) {

        this.x *= f;

        this.y *= f;

        return this;

      }

    };



    var Leaf = function (p, r, c, ctx) {

      this.p = p || null;

      this.r = r || 0;

      this.c = c || 'rgba(255,255,255,1.0)';

      this.ctx = ctx;

    }



    Leaf.prototype = {

      render: function () {

        var that = this;

        var ctx = this.ctx;

        var f = Branch.random(1, 2)

        for (var i = 0; i < 5; i++) {

          (function (r) {

            setTimeout(function () {

              ctx.beginPath();

              ctx.fillStyle = that.color;

              ctx.moveTo(that.p.x, that.p.y);

              ctx.arc(that.p.x, that.p.y, r, 0, Branch.circle, true);

              ctx.fill();

            }, r * 60);

          })(i);

        }

      }

    }





    var Branch = function (p, v, r, c, t) {

      this.p = p || null;

      this.v = v || null;

      this.r = r || 0;

      this.length = 0;

      this.generation = 1;

      this.tree = t || null;

      this.color = c || 'rgba(255,255,255,1.0)';

      this.register();

    };



    Branch.prototype = {

      register: function () {

        this.tree.addBranch(this);

      },

      draw: function () {

        var ctx = this.tree.ctx;

        ctx.beginPath();

        ctx.fillStyle = this.color;

        ctx.moveTo(this.p.x, this.p.y);

        ctx.arc(this.p.x, this.p.y, this.r, 0, Branch.circle, true);

        ctx.fill();

      },

      modify: function () {

        var angle = 0.18 - (0.10 / this.generation);

        this.p.add(this.v);

        this.length += this.v.length();

        this.r *= 0.99;

        this.v.rotate(Branch.random(-angle, angle)); //.mult(0.996);

        if (this.r < 0.8 || this.generation > 10) {

          this.tree.removeBranch(this);

          var l = new Leaf(this.p, 10, this.color, this.tree.ctx);

          l.render();

        }

      },

      grow: function () {

        this.draw();

        this.modify();

        this.fork();

      },

      fork: function () {

        var p = this.length - Branch.random(100, 200); // + (this.generation * 10);

        if (p > 0) {

          var n = Math.round(Branch.random(1, 3));

          this.tree.stat.fork += n - 1;

          for (var i = 0; i < n; i++) {

            Branch.clone(this);

          }

          this.tree.removeBranch(this);

        }

      }

    };



    Branch.circle = 2 * Math.PI;

    Branch.random = function (min, max) {

      return Math.random() * (max - min) + min;

    };

    Branch.clone = function (b) {

      var r = new Branch(new Vector(b.p.x, b.p.y), new Vector(b.v.x, b.v.y), b.r, b.color, b.tree);

      r.generation = b.generation + 1;

      return r;

    };

    Branch.rgba = function (r, g, b, a) {

      return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';

    };

    Branch.randomrgba = function (min, max, a) {

      return Branch.rgba(Math.round(Branch.random(min, max)), Math.round(Branch.random(min, max)), Math.round(Branch.random(min, max)), a);

    };



    var Tree = function () {

      var branches = [];

      var timer;

      this.stat = {

        fork: 0,

        length: 0

      };

      this.addBranch = function (b) {

        branches.push(b);

      };

      this.removeBranch = function (b) {

        for (var i = 0; i < branches.length; i++) {

          if (branches[i] === b) {

            branches.splice(i, 1);

            return;

          }

        }

      };

      this.render = function (fn) {

        var that = this;

        timer = setInterval(function () {

          fn.apply(that, arguments);

          if (branches.length > 0) {

            for (var i = 0; i < branches.length; i++) {

              branches[i].grow();

            }

          }

          else {

            //clearInterval(timer);

          }

        }, 1000 / 30);

      };

      this.init = function (ctx) {

        this.ctx = ctx;

      };

      this.abort = function () {

        branches = [];

        this.stat = {

          fork: 0,

          length: 0

        }

      };

    };





    function init() {



      // init



      var $window = $(window);

      var $body = $("body");

      var canvas_width = $window.width();

      var canvas_height = $window.height() - 500;

      var center_x = canvas_width / 2;

      var stretch_factor = 600 / canvas_height;

      var y_speed = 3 / stretch_factor;

      var $statMsg = $("#statMsg");



      // tx



      var canvas = $('#canvas')[0];

      canvas.width = canvas_width;

      canvas.height = canvas_height;

      var ctx = canvas.getContext("2d");

      ctx.globalCompositeOperation = "lighter";



      // tree



      var t = new Tree();

      t.init(ctx);

      for (var i = 0; i < 3; i++) {

        new Branch(new Vector(center_x, canvas_height), new Vector(Math.random(-1, 1), -y_speed), 15 / stretch_factor, Branch.randomrgba(0, 255, 0.3), t);

      }

      t.render(function () {

        $statMsg.html(this.stat.fork);

      });




    }





    $(function () {

      init();

    });





  })(jQuery);

</script>

<style type="text/css">
    body {
        padding: 0;
        margin: 0;
        background: #fff;
        font-family: Courier;
        position: relative;

    }
    .blog-header{
        position: absolute;
        top:0;
        left:0;
        height: calc(100% - 500px);
        color: #fff;
        width: 100%;
        padding-top: 10%;
    }
    canvas {
        background-image: url('/img/post-bg-universe.jpg');
        cursor: pointer;
    }
   /* .linear{
        background: -webkit-linear-gradient(top,#fc0,#f30 50%,#c00 51%,#600);
        -webkit-text-fill-color: transparent;
        background-clip:text;
    }*/

    .text{
        font:20px "微软雅黑";
        font-weight:bold;
        color:#aa0000;
    }

</style>

<canvas id='canvas'></canvas>
<!-- Page Header -->
<header class="blog-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 ">
                <div class="site-heading">
<!--
                    <h1>{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}</h1>
-->
                    <span class="subheading text">{{ page.description }}</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Main Content -->
<div class="container">
	<div class="row">
        {% if site.sidebar == false %}
<!-- NO SIDEBAR -->
    <!-- PostList Container -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 postlist-container">
                {{ content }}
            </div>
    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                {% if site.featured-tags %}
                <section>
                    <!-- no hr -->
                    <h5><a href="{{'/tags/' | prepend: site.baseurl }}">FEATURED TAGS</a></h5>
                    <div class="tags">
        				{% for tag in site.tags %}
                            {% if tag[1].size > {{site.featured-condition-size}} %}
                				<a href="{{ site.baseurl }}/tags/#{{ tag[0] }}" title="{{ tag[0] }}" rel="{{ tag[1].size }}">
                                    {{ tag[0] }}
                                </a>
                            {% endif %}
        				{% endfor %}
        			</div>
                </section>
                {% endif %}

                <!-- Friends Blog -->
                {% if site.friends %}
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">
                    {% for friend in site.friends %}
                        <li><a href="{{friend.href}}">{{friend.title}}</a></li>
                    {% endfor %}
                </ul>
                {% endif %}
            </div>
        {% else %}

<!-- USE SIDEBAR -->
    <!-- PostList Container -->
    		<div class="
                col-lg-8 col-lg-offset-1
                col-md-8 col-md-offset-1
                col-sm-12
                col-xs-12
                postlist-container
            ">
    			{{ content }}
    		</div>
    <!-- Sidebar Container -->
            <div class="
                col-lg-3 col-lg-offset-0
                col-md-3 col-md-offset-0
                col-sm-12
                col-xs-12
                sidebar-container
            ">
                <!-- Featured Tags -->
                {% if site.featured-tags %}
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="{{'/tags/' | prepend: site.baseurl }}">FEATURED TAGS</a></h5>
                    <div class="tags">
                        {% for tag in site.tags %}
                            {% if tag[1].size > {{site.featured-condition-size}} %}
                                <a href="{{ site.baseurl }}/tags/#{{ tag[0] }}" title="{{ tag[0] }}" rel="{{ tag[1].size }}">
                                    {{ tag[0] }}
                                </a>
                            {% endif %}
                        {% endfor %}
                    </div>
                </section>
                {% endif %}

                <!-- Short About -->
                <section class="visible-md visible-lg">
                    <hr><h5><a href="{{'/about/' | prepend: site.baseurl }}">ABOUT ME</a></h5>
                    <div class="short-about">
                        {% if site.sidebar-avatar %}
                            <img src="{{site.sidebar-avatar}}" />
                        {% endif %}
                        {% if site.sidebar-about-description %}
                            <p>{{site.sidebar-about-description}}</p>
                        {% endif %}
                        <!-- SNS Link -->
                        <ul class="list-inline">
                            {% if site.RSS %}
                            <li>
                                <a href="{{ "/feed.xml" | prepend: site.baseurl }}">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            {% endif %}
                            <!-- add jianshu add target = "_blank" to <a> by BY -->
                            {% if site.jianshu_username %}
                            <li>
                                <a target="_blank" href="https://www.jianshu.com/u/{{ site.jianshu_username }}">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa  fa-stack-1x fa-inverse">简</i>
                                    </span>
                                </a>
                            </li>
                            {% endif %}
                            {% if site.twitter_username %}
                            <li>
                                <a href="https://twitter.com/{{ site.twitter_username }}">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            {% endif %}
                            {% if site.zhihu_username %}
                            <li>
                                <a target="_blank" href="https://www.zhihu.com/people/{{ site.zhihu_username }}">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa  fa-stack-1x fa-inverse">知</i>
                                    </span>
                                </a>
                            </li>
                            {% endif %}
                            {% if site.weibo_username %}
                            <li>
                                <a target="_blank" href="http://weibo.com/{{ site.weibo_username }}">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            {% endif %}
                            {% if site.facebook_username %}
                            <li>
                                <a target="_blank" href="https://www.facebook.com/{{ site.facebook_username }}">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            {% endif %}
                            {% if site.github_username %}
                            <li>
                                <a target="_blank" href="https://github.com/{{ site.github_username }}">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            {% endif %}
                            
                        </ul>
                        {% if site.email %}
                            <p>✉️ {{site.email}}</p>
                        {% endif %}
                    </div>
                </section>
                <!-- Friends Blog -->
                {% if site.friends %}
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">
                    {% for friend in site.friends %}
                        <li><a href="{{friend.href}}">{{friend.title}}</a></li>
                    {% endfor %}
                </ul>
                {% endif %}
    		</div>
        {% endif %}
	</div>
</div>
